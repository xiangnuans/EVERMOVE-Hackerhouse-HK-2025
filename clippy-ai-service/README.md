# Clippy AI Service

## 项目概述
Clippy AI Service 是一个专门用于评估和评分AI助手的服务。它通过分析AI助手的行为、输出和文档，使用先进的评估模型来提供全面的评分和反馈。

## 核心算法组件

### 1. 评估模型架构
服务包含三个核心评估模型，每个模型专注于不同的评估维度：

#### 伦理评估模型 (Ethics Model)
- **功能**：评估AI助手的伦理合规性
- **评估维度**：
  - 公平性和无偏见
  - 透明度和可解释性
  - 隐私保护
  - 社会责任
- **应用场景**：确保AI助手的行为符合伦理标准

#### 行为追踪模型 (Trace Model)
- **功能**：追踪和分析AI助手的行为模式
- **评估维度**：
  - 决策过程追踪
  - 推理链分析
  - 行为一致性
  - 响应模式识别
- **应用场景**：理解AI助手如何做出决策

#### 信任评估模型 (Trust Model)
- **功能**：评估AI助手的可信度
- **评估维度**：
  - 回答准确性
  - 信息可靠性
  - 专业领域知识
  - 一致性表现
- **应用场景**：确保AI助手的输出值得信赖

### 2. 评估流程
1. **数据收集**
   - 获取Agent基本信息
   - 下载相关文档
   - 收集历史交互数据

2. **多维度分析**
   - 伦理合规性检查
   - 行为模式分析
   - 可信度评估

3. **综合评分**
   - 权重计算
   - 多维度分数整合
   - 最终评分生成

4. **反馈生成**
   - 详细分析报告
   - 改进建议
   - 最佳实践推荐

## 技术栈
- **后端框架**：NestJS
- **编程语言**：TypeScript
- **AI模型**：Deepseek API
- **评估模型**：自定义Python模型（可选）

## 项目结构
```
clippy-ai-service/
├── src/
│   ├── controllers/        # API控制器
│   ├── services/          # 业务逻辑服务
│   ├── models/           # 数据模型
│   ├── guards/           # 安全守卫
│   └── filters/          # 异常过滤器
├── models/               # Python评估模型（可选）
│   ├── ethics_model.py   # 伦理评估模型
│   ├── trace_model.py    # 行为追踪模型
│   └── trust_model.py    # 信任评估模型
└── test/                # 测试文件
```

## API端点

### 1. 内容分析
- **URL**: `POST /api/analysis`
- **功能**: 分析AI助手的内容并给出评分
- **请求格式**:
```json
{
  "content": "待分析的内容"
}
```
- **响应格式**:
```json
{
  "score": 85,
  "feedback": "详细的分析反馈"
}
```

### 2. 内部API（用于服务间通信）

#### 获取Agent列表及文件URL
- **URL**: `/api/internal/agents`
- **方法**: GET
- **描述**: 获取所有活跃的Agent及其文件的下载URL

#### 更新Agent评分
- **URL**: `/api/internal/agents/:id/rating`
- **方法**: POST
- **描述**: 更新特定Agent的评分和反馈

#### 文件下载
- **URL**: `/api/files/:id/download`
- **方法**: GET
- **描述**: 下载特定文件

## 安装和运行

### 环境要求
- Node.js >= 14
- Python >= 3.8（如果使用Python评估模型）
- npm 或 yarn

### 安装步骤
1. 克隆仓库
2. 安装依赖：
```bash
npm install
```
3. 配置环境变量：
   - 复制 `.env.example` 到 `.env`
   - 配置必要的环境变量

### 运行服务
```bash
# 开发模式
npm run start:dev

# 生产模式
npm run start:prod
```

## 安全说明
- API密钥保护
- IP地址限制
- 环境变量配置
- 文件访问控制

## 错误处理
- 标准HTTP状态码
- 统一的错误响应格式
- 详细的错误信息

## 与主后端集成
1. 配置环境变量
2. 设置API密钥
3. 调用相应的API端点

## 开发注意事项
- 代码规范
- 测试要求
- 部署流程

## 故障排除
- 常见问题
- 解决方案
- 日志查看 